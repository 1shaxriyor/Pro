{% extends 'base.html' %}
{% block title %}
  Buyurtma berish
{% endblock %}

{% block content %}
  <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/css/bootstrap.min.css" rel="stylesheet" />

  <div class="container">
    <h2 class="text-center mb-4">Xizmatlarga Buyurtma</h2>

    <!-- Xizmat tanlash -->
    <div class="mb-3">
      <label for="serviceSelect" class="form-label">Xizmat turini tanlang</label>
      <select class="form-select" id="serviceSelect">
        <option value="" selected disabled>-- Xizmat tanlang --</option>
        <option value="usta">Usta</option>
        <option value="santexnik">Santexnik</option>
        <option value="svarshik">Svarshik</option>
      </select>
    </div>

    <!-- Ustalar ro'yxati -->
    <div class="mb-3 form-section" id="mastersSection" style="display:none;">
      <label for="masterSelect" class="form-label">Ustani tanlang</label>
      <select class="form-select" id="masterSelect">
        <option value="" selected disabled>-- Usta tanlang --</option>
      </select>
    </div>

    <!-- Kontakt ma'lumotlari -->
    <div class="form-section" id="contactSection" style="display:none;">
      <h5>Kontakt ma'lumotlari</h5>
      <form id="orderForm">
        <div class="mb-3">
          <label for="name" class="form-label">Ismingiz</label>
          <input type="text" class="form-control" id="name" placeholder="Ismingizni kiriting" required />
        </div>
        <div class="mb-3">
          <label for="phone" class="form-label">Telefon raqam</label>
          <input type="tel" class="form-control" id="phone" placeholder="+998 90 123 45 67" required />
        </div>
        <div class="mb-3">
          <label for="address" class="form-label">Manzil</label>
          <input type="text" class="form-control" id="address" placeholder="Manzilingizni kiriting" required />
        </div>
        <button type="submit" class="btn btn-primary">Buyurtma berish</button>
      </form>
    </div>
  </div>

  <script>
    const serviceSelect = document.getElementById('serviceSelect')
    const masterSelect = document.getElementById('masterSelect')
    const mastersSection = document.getElementById('mastersSection')
    const contactSection = document.getElementById('contactSection')
    
    const masters = {
      usta: ['Usta Ali', 'Usta Bobur', 'Usta Doston'],
      santexnik: ['Santexnik Javlon', 'Santexnik Sardor', 'Santexnik Anvar'],
      svarshik: ['Svarshik Komil', 'Svarshik Rustam', 'Svarshik Orif']
    }
    
    // Xizmat tanlaganda ustalarni ko'rsatish
    serviceSelect.addEventListener('change', () => {
      const selectedService = serviceSelect.value
      masterSelect.innerHTML = '<option value="" selected disabled>-- Usta tanlang --</option>'
      if (masters[selectedService]) {
        masters[selectedService].forEach((master) => {
          const option = document.createElement('option')
          option.value = master
          option.textContent = master
          masterSelect.appendChild(option)
        })
        mastersSection.style.display = 'block'
        contactSection.style.display = 'none'
      }
    })
    
    // Usta tanlaganda kontakt formani ko'rsatish
    masterSelect.addEventListener('change', () => {
      contactSection.style.display = masterSelect.value ? 'block' : 'none'
    })
    
    // Formani submit qilish
    const orderForm = document.getElementById('orderForm')
    orderForm.addEventListener('submit', (e) => {
      e.preventDefault()
      alert('Buyurtma muvaffaqiyatli yuborildi!')
      orderForm.reset()
      serviceSelect.value = ''
      masterSelect.innerHTML = '<option value="" selected disabled>-- Usta tanlang --</option>'
      mastersSection.style.display = 'none'
      contactSection.style.display = 'none'
    })
  </script>
{% endblock %}
